<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>ðŸ“˜ Smart Study Planner</title>
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
 <style>
  body {
    margin: 0;
    padding: 0;
    font-family: 'Poppins', sans-serif;
    background: #F5F7FA;
    transition: margin-left 0.4s ease-in-out;
  }

  /* Sidebar */
  .slider {
   width: 200px;
   height: 100vh;
   background-color: #2563EB;
   position: fixed;
   top: 0;
   left: 0;
   transform: translateX(-200px);
   transition: transform 0.4s ease-in-out;
   color: white;
   padding: 20px 10px;
   box-sizing: border-box;
   z-index: 998;
   display: flex;
   flex-direction: column;
  }

  body.open .slider {
    transform: translateX(0);
  }

  body.open .content {
    margin-left: 200px;
  }

  /* Navbar */
  .navbar {
    background-color: #2563EB;
    color: white;
    display: flex;
    align-items: center;
    text-align: center;
    justify-content: spa;
    padding: 10px 20px;
    position: sticky;
    top: 0;
    z-index: 50;
  }
  .navbar h1 {
   display: flex;
   align-items: center;
   justify-content: center;
    text-align: center;
  }

  .slidbtn button {
    width: 40px;
    height: 40px;
    background-color: rgb(15, 16, 17);
    color: white;
    border: none;
    cursor: pointer;
    font-size: 20px;
    border-radius: 5px;
    transition: background 0.2s;
  }

  .slidbtn button:hover {
    background-color: rgb(30, 30, 30);
  }

  .menu button {
    display: block;
    width: 100%;
    padding: 12px;
    margin: 10px 0;
    border: none;
    border-radius: 8px;
    background: white;
    color: #007bff;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    text-align: left;
    transition: all 0.3s ease;
  }

  .menu button:hover {
    background: #0056b3;
    color: white;
    transform: translateX(5px);
  }

  .content {
    padding: 20px;
    transition: margin-left 0.4s ease-in-out;
  }
  h1{
    display: flex;
    text-align: center;
    justify-content: space-between;
    align-items: center;
    padding-left: 500px;


  }

  /* Dashboard Cards */
  .grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .grid > div {
    background: white;
    border-radius: 1rem;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    padding: 1.5rem;
  }

  .grid h3 {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .grid p {
    margin-top: 0.5rem;
  }

  .text-3xl { font-size: 1.875rem; }
  .text-indigo-600 { color: #4f46e5; }
  .text-orange-500 { color: #f97316; }
  .text-purple-500 { color: #a855f7; }
  .text-green-500 { color: #22c55e; }
 </style>
</head>
<body>

  <nav class="navbar">
    <div class="slidbtn">
      <button id="slider-btn" onclick="slidbar()">â˜°</button>
    </div>
  <h1 style="color:#f8f8f9; font-size:28px; font-weight:bold; text-align:center; margin-bottom:20px;">
     ðŸ“˜Brainwave Dashboard
</h1>

  </nav>

  <div class="slider" id="slider">
    <h2>Menu</h2>
    <div class="menu">
      <button onclick="location.href='/dashboard/'"><i class="fa-solid fa-chart-line"></i> Dashboard</button>
      <button onclick="location.href='/planner/'"><i class="fa-regular fa-calendar"></i> Planner</button>
      <button onclick="location.href='/chatbot/'"><i class="fa-regular fa-message"></i> Chatbot</button>
      <button onclick="location.href='/notes_summariser/summariser'">ðŸ“˜ Video to Notes</button>
      <button onclick="location.href='/quiz/'"><i class="fa-solid fa-medal"></i> Quizzes</button>
      <button onclick="location.href='/progress/'"><i class="fa-solid fa-arrow-trend-up"></i> Progress</button>
    </div>
  </div>

  <main class="content">
    <div class="grid" id="dashboard-cards">
      <div>
        <h3>Today's Study Time</h3>
        <p id="study-time" class="text-3xl text-indigo-600">0m</p>
      </div>
      <div>
        <h3>Study Streak</h3>
        <p id="study-streak" class="text-3xl text-orange-500">0 ðŸ”¥</p>
      </div>
      <div>
        <h3>Quizzes Done</h3>
        <p id="quizzes-done" class="text-3xl text-purple-500">0</p>
      </div>
      <div>
        <h3>Average Score</h3>
        <p id="average-score" class="text-3xl text-green-500">0%</p>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
      <div class="bg-white rounded-2xl shadow-md p-6">
        <h3 class="text-lg font-semibold mb-3 text-indigo-600">Weekly Study Progress</h3>
        <canvas id="studyChart"></canvas>
      </div>
      <div class="bg-white rounded-2xl shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4 text-orange-500">Upcoming Tasks</h3>
        <ul class="space-y-3" id="upcoming-list"></ul>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    function slidbar() {
      document.body.classList.toggle('open');
      const sliderBtn = document.getElementById('slider-btn');
      sliderBtn.style.display = document.body.classList.contains('open') ? 'none' : 'inline-block';
    }

    document.addEventListener('DOMContentLoaded', function() {
      const menuHeading = document.querySelector('.slider h2');
      menuHeading.addEventListener('click', function() {
        document.body.classList.remove('open');
        document.getElementById('slider-btn').style.display = 'inline-block';
      });
      loadDashboardData();
    });

    async function loadDashboardData() {
      try {
        const response = await fetch('/api/dashboard-data');
        const data = await response.json();
        console.log("ðŸ“Š Dashboard Data:", data);

        document.getElementById('study-time').textContent = data.studyTimeToday + 'm';
        document.getElementById('study-streak').textContent = data.studyStreak + ' ðŸ”¥';
        document.getElementById('quizzes-done').textContent = data.quizzesDone;
        document.getElementById('average-score').textContent = data.averageScore + '%';

        const ctx = document.getElementById('studyChart').getContext('2d');
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
            datasets: [{
              label: 'Study Minutes',
              data: data.weeklyProgress,
              borderColor: '#6366f1',
              backgroundColor: 'rgba(99,102,241,0.2)',
              tension: 0.4,
              fill: true
            }]
          },
          options: {
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true }, x: { grid: { display: false } } }
          }
        });

        const upcomingList = document.getElementById('upcoming-list');
        upcomingList.innerHTML = '';
        data.upcomingTasks.forEach(task => {
          const li = document.createElement('li');
          li.className = 'upcoming-task';
          li.innerHTML = `
            <div>
              <p class="font-medium text-gray-700">${task.task}</p>
              <span class="text-xs text-gray-400">${task.date}</span>
            </div>
            <span class="bg-${task.priority === 'high' ? 'red' : 'yellow'}-100 text-${task.priority === 'high' ? 'red' : 'yellow'}-500">${task.priority}</span>
          `;
          upcomingList.appendChild(li);
        });

      } catch (err) {
        console.error('Error loading data:', err);
      }
    }
  </script>
</body>
</html>